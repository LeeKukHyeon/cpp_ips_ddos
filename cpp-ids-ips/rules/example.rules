# example.rules - º¹ÇÕ ·ê + detection_filter/dthreshold examples

# 1) SQLi PCRE + content (simple)
alert tcp any any -> any 80 (msg:"SQL Injection attempt"; content:"union select"; pcre:"/union\s+select/i"; sid:1000001;)

# 2) XSS attempt
alert tcp any any -> any 80 (msg:"XSS attempt"; content:"<script"; pcre:"/<script.*?>/i"; sid:1000002;)

# 3) SSH banner
alert tcp any any -> any 22 (msg:"SSH banner detected"; content:"SSH-"; sid:1000003;)

# 4) SYN flood threshold (track by_src, threshold type)
alert tcp any any -> any 80 (msg:"SYN flood (threshold)"; sid:2000001; detection_filter: track by_src, count 5, seconds 2; flags:SYN;)

# 5) HTTP GET flood (limit type) - allow at most 10 alerts per 3s per source
alert tcp any any -> any 80 (msg:"HTTP GET flood (limit)"; content:"GET "; sid:2000002; detection_filter: track by_src, count 10, seconds 3, type limit;)

# 6) HTTP GET flood (both) - require threshold then limit alerts
alert tcp any any -> any 80 (msg:"HTTP GET flood (both)"; content:"GET "; sid:2000003; detection_filter: track by_src, count 30, seconds 5, type both;)

# 7) Complex chain
alert tcp any any -> any 80 (msg:"Complex chain example"; content:"start"; offset:0; depth:80; content:"middle"; distance:1; within:20; content:"end"; sid:9001;)
